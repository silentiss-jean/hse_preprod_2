<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Home Suivi √âlec</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="style.hse.themes.css">
<link rel="stylesheet" href="features/summary/summary.css">
<link rel="stylesheet" href="features/diagnostics/diagnostics.css">
<link rel="stylesheet" href="features/migration/migration.css">

<style>
body { font-family: "Segoe UI", Roboto, Arial, sans-serif; background-color: #f8f9fa; color: #222; margin: 20px; }
h1 { text-align: center; color: #0078d4; margin-bottom: 20px; }
nav#tabs { text-align: center; margin-bottom: 20px; }
nav#tabs button { background-color: #0078d4; color: white; border: none; padding: 10px 15px; margin: 2px; border-radius: 5px; cursor: pointer; transition: 0.2s; }
nav#tabs button:hover { background-color: #005fa3; }
.tab-content { display: none; }
.tab-content.active { display: block; }
.card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 1px 4px rgba(0,0,0,0.1); margin-bottom: 20px; }
.integration-block { background: #fff; border-radius: 8px; padding: 10px 15px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
.integration-block h3 { color: #0078d4; }
.sensor { margin-left: 10px; margin-bottom: 3px; }
button.primary { background-color: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; }
button.primary:hover { background-color: #218838; }
label { display: block; margin: 5px 0; }
#externalFieldsConfig { background: #eef4ff; border-radius: 8px; padding: 10px; margin-top: 8px; border-left: 3px solid #0078d4; }
.reference-panel { display:flex; align-items:flex-start; gap:12px; background:#eef4ff; border-left:4px solid #0078d4; padding:12px; border-radius:8px; margin-bottom:12px; }
.reference-icon { font-size:18px; }
.reference-title { font-weight:600; }
.reference-name { font-family: monospace; }
.set-reference-btn { margin-left:auto; }
table { width:100%; border-collapse: collapse; }
table th, table td { border: 1px solid #e5e5e5; padding: 6px 8px; }
table thead th { background: #f2f2f2; }
.config-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.config-section { background: #f4f8ff; border-left: 4px solid #0078d4; padding: 15px; border-radius: 8px; margin-top: 15px; }
.config-section.hphc { background: #fff4e6; border-left-color: #ff9800; }
.config-section h4 { margin-top: 0; color: #0078d4; }
.config-section.hphc h4 { color: #ff9800; }
</style>
</head>
<body>
<h1>‚ö° Home Suivi √âlec</h1>

<nav id="tabs">
  <button type="button" onclick="showTab('home')">üè† Accueil</button>
  <button type="button" onclick="showTab('diagnostics')">üîß Diagnostic</button>
  <button type="button" onclick="showTab('detection')">üîç D√©tection</button>
  <button type="button" onclick="showTab('configuration')">‚öôÔ∏è Configuration</button>
  <button type="button" onclick="showTab('customisation')">üé® Customisation</button>
  <button type="button" onclick="showTab('generation')">üß© G√©n√©ration cartes</button>
  <button type="button" onclick="showTab('migration')">üß© Migration capteurs</button>
</nav>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     üè† ACCUEIL - R√âSUM√â G√âN√âRAL
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="home" class="tab-content active">
  <!-- ‚ú® Boutons d'actions avec cache -->
  <div style="display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; align-items: center;">
    <button id="refreshHome" class="primary" type="button">
      üîÑ Actualiser r√©sum√©
    </button>
    <button id="clearCache" class="btn-cache-clear" type="button">
      üóëÔ∏è Vider cache
    </button>
    <button id="showCacheStats" class="btn-cache-stats" type="button">
      üìä Stats cache
    </button>
  </div>

  <!-- ‚ú® Panneau stats cache (masqu√© par d√©faut) -->
  <div id="cacheStatsPanel" style="display:none;">
    <strong>üìä Statistiques du cache</strong>
    <div id="cacheStatsContent">Chargement...</div>
  </div>

  <h2>R√©sum√© g√©n√©ral</h2>
  <div id="summaryCard" class="card">
    <!-- ‚úÖ Bloc stats existant (conserv√© tel quel) -->
    <div id="topBlocks" style="display: flex; justify-content: space-between; gap: 20px; margin-bottom: 20px;">
      <div id="instantaneBlock" style="flex: 1; background: #eef4ff; border-radius: 8px; padding: 15px; font-size: 1rem;">
        <h3>Capteurs</h3>
        <p><strong>Total capteurs d√©tect√©s :</strong> <span id="totalCapteurs">-</span></p>
        <p><strong>Capteurs s√©lectionn√©s :</strong> <span id="actifsCapteurs">-</span></p>
        <p><strong>Capteurs s√©lectionn√©s (tous actifs) :</strong> <span id="instantaneInterne">- W</span></p>
        <p><strong id="externalTitle"></strong> <span id="externeCompact"></span> <abbr title="Valeur mesur√©e en temps r√©el, co√ªt HT r√©el">*</abbr></p>
        <p><strong>Consommation actuelle non mesur√©e (Delta) :</strong> <span id="deltaPuissance">- W</span></p>
      </div>
      <div id="resumeGeneral" style="flex: 1; background: #f5f5f5; border-radius: 8px; padding: 15px; font-size: 0.92rem;">
        <h3>R√©sum√© g√©n√©ral</h3>
        <p><strong>Type contrat :</strong> <span id="typeContratSummary">-</span></p>
        <p><strong>Abonnement HT :</strong> <span id="abonnementHTSummary">-</span> ‚Ç¨</p>
        <p><strong>Abonnement TTC :</strong> <span id="abonnementTTCSummary">-</span> ‚Ç¨</p>
        <div id="blocFixe" style="display:none; margin-top:10px;">
          <p><strong>Prix du kWh HT :</strong> <span id="prixFixeHT">-</span> ‚Ç¨</p>
          <p><strong>Prix du kWh TTC :</strong> <span id="prixFixeTTC">-</span> ‚Ç¨</p>
        </div>
        <div id="blocHpHc" style="display:none; margin-top:10px;">
          <p><strong>Tarif HP HT :</strong> <span id="tarifHPHTSummary">-</span> ‚Ç¨</p>
          <p><strong>Tarif HP TTC :</strong> <span id="tarifHPTTCSummary">-</span> ‚Ç¨</p>
          <p><strong>Tarif HC HT :</strong> <span id="tarifHCHTSummary">-</span> ‚Ç¨</p>
          <p><strong>Tarif HC TTC :</strong> <span id="tarifHCTTCSummary">-</span> ‚Ç¨</p>
          <p><strong>Heures HC d√©but :</strong> <span id="heuresHPDebutSummary">-</span></p>
          <p><strong>Heures HC fin :</strong> <span id="heuresHPFinSummary">-</span></p>
        </div>
        <div id="tarifsSummary"></div>
        <p><strong>Dernier refresh :</strong> <span id="dernierRefresh">-</span></p>
      </div>
    </div>

    <!-- ‚úÖ Conteneur pour √©tat de chargement / erreur (backend-powered) -->
    <div id="summaryContent"></div>

    <!-- ‚úÖ Tables R√©sum√© (IDs mis √† jour pour backend-powered) -->
    <section id="summaryData" style="display:none">
      <div id="tablesDetail" style="margin-top: 10px;">
        <h3>Capteurs d√©tect√©s ‚Äì Puissance cumul√©e</h3>
        <table id="summaryInternalSensors">
          <thead>
            <tr>
              <th>P√©riode</th>
              <th>kWh</th>
              <th>Co√ªt consommation HT (‚Ç¨)</th>
              <th>Co√ªt consommation TTC (‚Ç¨)</th>
              <th>Total HT (‚Ç¨)</th>
              <th>Total TTC (‚Ç¨)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="6" style="text-align: center; color: #666; padding: 20px;">
                S√©lectionnez et configurez vos capteurs pour que le r√©sum√© affiche des estimations
              </td>
            </tr>
          </tbody>
        </table>

        <h3 id="externalSummaryTitle" style="margin-top:30px;">Capteur externe de r√©f√©rence</h3>
        <table id="summaryExternalSensors">
          <thead>
            <tr>
              <th>P√©riode</th>
              <th>kWh</th>
              <th>Co√ªt consommation HT (‚Ç¨)</th>
              <th>Co√ªt consommation TTC (‚Ç¨)</th>
              <th>Total HT (‚Ç¨)</th>
              <th>Total TTC (‚Ç¨)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <h3 id="deltaSummaryTitle" style="margin-top:30px;">Delta (externe - interne)</h3>
        <table id="summaryDeltaSensors">
          <thead>
            <tr>
              <th>P√©riode</th>
              <th>kWh</th>
              <th>Co√ªt consommation HT (‚Ç¨)</th>
              <th>Co√ªt consommation TTC (‚Ç¨)</th>
              <th>Total HT (‚Ç¨)</th>
              <th>Total TTC (‚Ç¨)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <p id="summaryMessage" style="font-size: 0.8em; color: #666; margin-top: 10px;">
          S√©lectionnez et configurez vos capteurs pour que le r√©sum√© affiche des estimations
        </p>
      </div>
    </section>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     AUTRES ONGLETS (inchang√©s)
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="diagnostics" class="tab-content"></div>
<div id="detection" class="tab-content"></div>
<div id="configuration" class="tab-content"></div>
<div id="customisation" class="tab-content"></div>
<div id="generation" class="tab-content"></div>
<div id="migration" class="tab-content"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SCRIPTS
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script type="module" src="core/app.js"></script>
<script type="module" src="core/router.js"></script>
</body>
</html>
